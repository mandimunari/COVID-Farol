# Amanda ImpulsoGov

# Desafio ImpulsoGov | Cientista de Dados üß™

## Quest√µes

### Proje√ß√£o subestimada

**1. (descritiva) O SimulaCovid, nosso simulador de demanda hospitalar por leitos enfermaria e UTI, est√° subestimando o n√∫mero de interna√ß√µes por Covid-19 em diversos estados brasileiros. Leia com aten√ß√£o o c√≥digo fonte disponibilziado neste reposit√≥rio e as instru√ß√µes do c√°lculo de proje√ß√£o no notebook, e responda: o que pode estar acontecendo?**

O fator que pode estar influenciando na proje√ß√£o subestimada do n√∫mero de interna√ß√µes por Covid-19 em diversos estados brasileiros pode ser o fato de que algumas vari√°veis selecionadas para a constru√ß√£o do modelo de proje√ß√£o n√£o possuem rela√ß√£o linear.

**2. (descritiva/implementa√ß√£o) Como voc√™ resolveria esse problema? Indique seu racioc√≠nio, hip√≥teses, testes realizados e implemente at√© onde poss√≠vel com base nos dados da nosssa API.**


Para entender qual fator est√° relacionado ao processo de subestimar o n√∫mero de interna√ß√µes por Covid-19 em diversos estados brasileiros, eu iniciei uma an√°lise explorat√≥ria dos dados de cada banco, em seguida interpretei os c√≥digos a fim de entender a l√≥gica do modelo,bem como testes as duas fun√ß√µes contidas no arquivo simualdor.py, ou seja, a fun√ß√£o simulador.get_dday e simulador.run_simulation. Ap√≥s estar familiarizada com a estrutura do modelo eu tentei tra√ßar hip√≥teses baseadas nas observa√ß√µes dos dados e do c√≥digo. Com isso cheguei a  seguinte hip√≥tese: em um modelo de proje√ß√£o, se a rela√ß√£o entre cada vari√°vel preditora e a vari√°vel de crit√©rio for n√£o linear, ent√£o as proje√ß·∫Ωos podem superestimar sistematicamente os valores reais para uma faixa de valores em uma vari√°vel preditora e subestim√°-los para outra. Essa hip√≥tese pode ser confirmada atrav√©s de um teste de correla√ß√£o, o qual dedica-se a infer√™ncias estat√≠sticas das medidas de associa√ß√£o linear que mede a ‚Äúfor√ßa‚Äù ou ‚Äúgrau‚Äù de relacionamento linear entre duas vari√°veis. Essa medida varia de 1 a -1, sendo os valores pr√≥ximos 0 representando uma baixa correla√ß√£o linear, ou seja, indicando vari√°veis que possuem rela√ß√£o n√£o linear. Valores pr√≥ximos de 1 indicam rela√ß√µes lineares positivas, e valores pr√≥ximos a -1 indicam rela√ß√µes lineares negativas. Ent√£o para testar essa hip√≥tese eu realizei um teste de correla√ß√£o com os dados do banco http://datasource.coronacidades.org/br/states/parameters e do banco http://datasource.coronacidades.org/br/states/farolcovid/main. 

Para o teste de correla√ß√£o foi utilizada a fun√ß√£o .corr() e para gerar a visualiza√ß√£o do heatmap utilizou-se biblioteca seaborn e a fun√ß√£o seaborn.heatmap(). O script para a an√°lise de correla√ß√£o pode ser visto em ***correlation_analysis.ipynb*** O heatmap gerado pode ser visualizado abaixo, atrav√©s dele podemos observar que a correla√ß√£o entre as vari√°veis notification_rate e number_icu_beds; bem como, a correla√ß√£o das vari√°veis rt_most_likely e fatality_ratio s√£o iguais a 0, ou seja, essas vari√°veis n√£o possuem correla√ß√£o entre si. Al√©m disso, existem vari√°veis que possuem uma correla√ß√£o baixa entre sim. Dentre elas temos: confirmed_case com notification_rate; confirmed_case com rt_most_likely; deaths com notification_rate; deaths com rt_most_likely; active_cases com notification_rate; rt_most_likely com todas as outras vari√°veis; e number_beds com notification_rate. 

![](figures/figure1.png)

**Figura 1.** Matriz de correla√ß√£o das vari√°veis do banco de dados do CoronaCidades e do FarolCovid. Valores pr√≥ximos 0, representado pela tonalidade de vermelho, demonstra uma baixa correla√ß√£o linear, ou seja, indica vari√°veis que possuem rela√ß√£o n√£o linear. Valores pr√≥ximos de 1, representados pela tonalidade laranja, indicam rela√ß√µes lineares positivas, ou seja, vari√°veis que possuem correla√ß√£o e s√£o diretamente proporcionais. J√° valores pr√≥ximos a -1, representados pela tonalidade roxa, indicam rela√ß√µes lineares negativas, ou seja, vari√°veis que s√£o inversamente proporcionais.

Nessa situa√ß√£o onde diversas vari√°veis possuem baixa correla√ß√£o ou n√£o possuem correla√ß√£o, existem duas alternativas vi√°veis: (1) fazer transfroma√ß√µes com essas vari√°veis e utilizar modelos de regress√£o lineares ou; (2) usar modelos de regress√£o n√£o lineares. Nesse caso, eu testei usar um modelo de regress√£o n√£o linear usando o pacote do R **nls.multstart** atrav√©s da f√≥rmula: *I1 ~ beta1 * (I2^beta2) * (I3^beta3)*. Infelizmente eu tive problemas com a leitura dos pacotes do R dentro do Python (o c√≥digo da implementa√ß√£o de um modelo de regress√£o n√£o linear est√° dispon√≠vel no arquivo ******). No entanto 

**3. (descritiva) Quais s√£o as vantagens e desvantagens dessa solu√ß√£o? (Caso tenha descrito mais de uma solu√ß√£o acima, escolha a mais pertinente) Existe alguma dificuldade dessa solu√ß√£o ser implementada no c√≥digo da ferramenta?**

A solu√ß√£o seria usar um modelo de regress√£o n√£o linear, as vantagens de se us√°-lo √© que enquanto as equa√ß√µes lineares possuem uma forma b√°sica, as equa√ß√µes n√£o-lineares podem assumir muitas formas diferentes; por isso, a regress√£o n√£o-linear proporciona um ajuste de curva mais flex√≠vel, bem como as fun√ß√µes desse tipo de regress√£o podem ter mais de um par√¢metro por vari√°vel preditora. Por outro lado, as principais desvantagens est√£o relacionadas ao fato de que, esse tipo de regress√£o, permite um n√∫mero quase infinito de fun√ß√µes poss√≠veis, isso pode gerar uma certa dificuldade de configur√°-lo. Al√©m disso, os intervalos de confian√ßa podem ou n√£o ser calcul√°veis, vai depender do modelo desenvolvido. Adicionalmente, os m√©todos de infer√™ncia s√£o aproximados e requerem procedimentos iterativos de estima√ß√£o baseados no fornecimento de valores iniciais para os par√¢metros. 

A implementa√ß√£o de um modelo de regress√£o n√£o linear se mostra vi√°vel, principalmente pelo fato dos autores Milhinhos & Costa (2020) **(paper dispon√≠vel em arquivo andditional_material/ActiveCasesUsingNonlinearRegression.pdf)** terem descrito nesse estudo a modelagem da progress√£o dos casos ativos de Covid em Portugal por meio de regress√£o n√£o linear. Nesse estudo, os autores optaram pela abordagem de regress√£o n√£o linear justamente porque os dados do m√™s de Julho 2020 diferiram muito das indica√ß√µes positivas do modelo anterior, o qual subestimou o n√∫mero de casos ativos. No caso deste estudo, foram utilizados os par√¢metros do modelo atrav√©s da estimativa de m√≠nimos quadrados usando o pacote *drc* do R. Al√©m desse pacote, no R existem uma fun√ß√£o e um pacote que s√£o utilizadas nesses casos de regress√£o n√£o linear: (1) a fun√ß√£o *nls()*; e (2) o pacote *nlme*. Essas fun√ß√µes e pacotes do R, espec√≠ficos para regress√£o n√£o linear, podem ser usadas dentro do python atrav√©s da biblioteca rpy2. Em vista disso, se mostra poss√≠vel a integra√ß√£o de modelos de regress√£o n√£o linear ao c√≥digo j√° desenvolvido.
